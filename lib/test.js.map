{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 71e4270efd3420bf86c0","webpack:///./src/pieces.js","webpack:///./src/AI.js","webpack:///./src/index.js","webpack:///./src/game.js","webpack:///./test/index.js"],"names":["PIECE_CHARS","pawn","W","B","rook","knight","bishop","queen","king","Piece","x","y","charBase","color","game","type","char","FENname","charAt","toUpperCase","empty","prototype","getValidMoves","Pawn","call","simulate","moves","turn","length","board","last","turnTo","turnFrom","figX","passantLast","passantFig","colorY","colorY2","passantY2","figXArray","push","i","to","from","movePiece","piece","validMoves","simulateAndFilter","Rook","forEach","coef","index","Knight","task","coordinates","one","two","help","boardPiece","Bishop","Queen","rookMoves","bishopMoves","concat","King","rochade","self","coord","xx","yy","kingMoved","some","props","rookX","newKingX","dir","ev","safe","evv","evMove","Chess_AI","bestMove","bestValue","allMoves","simpleMovePiece","boardValue","evaluateBoard","totalEvaluation","j","getPieceValue","getAbsoluteValue","absoluteValue","Graphics","Game","AI","promoCallback","arrayIn","FEN","FENboard","threefold","gameToFEN","boardToFEN","moveSelected","selected","promotionCallback","checkmateCallback","playAgainstAI","validMove","vm","take","paste","threefoldCheck","halfmoveClock","promotePawn","checkmateColor","checkmateValue","checkmate","move","warning","result","yyy","xxx","mmm","count","pieceToAN","xChars","missingPieces","activeColour","activeColor","castlingTarget","possibleCastling","whiteKingMoved","blackKingMoved","rookY","castlingSide","enPassantTarget","fullmoveCount","initializeGame","defaultGame","bestAI","console","log"],"mappings":"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","file":"test.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"rsg-chess\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"rsg-chess\"] = factory();\n\telse\n\t\troot[\"rsg-chess\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 71e4270efd3420bf86c0","//\r\n// RSG Chess\r\n// Licensed under Apache 2.0 LICENSE\r\n\r\nexport var PIECE_CHARS = {\r\n  pawn: { W: \"♙\", B: \"♟\" },\r\n  rook: { W: \"♖\", B: \"♜\" },\r\n  knight: { W: \"♘\", B: \"♞\" },\r\n  bishop: { W: \"♗\", B: \"♝\" },\r\n  queen: { W: \"♕\", B: \"♛\" },\r\n  king: { W: \"♔\", B: \"♚\" }\r\n};\r\n\r\nfunction Piece(x, y, charBase, color, game, type) {\r\n  if (charBase) this.char = charBase[color];\r\n  this.color = color;\r\n  this.x = x;\r\n  this.y = y;\r\n  this.game = game;\r\n  this.type = type;\r\n  if (type) {\r\n    var FENname = type === 'knight' ? 'n' : type.charAt(0);\r\n    if(this.color === 'W') FENname = FENname.toUpperCase();\r\n    this.FENname = FENname;\r\n  }\r\n}\r\n\r\nPiece.empty = function () {\r\n return new Piece(); \r\n};\r\n\r\nPiece.prototype.getValidMoves = function() {\r\n  return [\r\n    {x:0, y:0},\r\n    {x:7, y:7}\r\n  ];\r\n};\r\n\r\nfunction Pawn(x, y, color, game) {\r\n  Piece.call(this, x, y, PIECE_CHARS.pawn, color, game, 'pawn');\r\n}\r\n\r\nPawn.prototype = Piece.empty();\r\nPawn.prototype.getValidMoves = function(simulate) {\r\n  var game = this.game;\r\n  var moves = [];\r\n  var y = this.y;\r\n  var x = this.x;\r\n  var turn = game.turn;\r\n  var length = turn.length;\r\n  var board = game.board;\r\n  var last, turnTo, turnFrom, figX, passantLast, passantFig;\r\n  var colorY = this.color === \"W\" ? y - 1 : y + 1;  \r\n  var colorY2 = this.color === \"W\" ? y - 2 : y + 2;  \r\n  var passantY2 = this.color === \"W\" ? 3 : 4;  \r\n  var figXArray = [x - 1, x + 1];\r\n\r\n  if(colorY < 8 && colorY >= 0 && !board[colorY][x]){\r\n    moves.push({x: x, y: colorY});\r\n    if((y == 1 || y == 6) && colorY2 < 8 && colorY2 >= 0 && !game.board[colorY2][x]){\r\n      moves.push({x: x, y: colorY2});\r\n    }\r\n  }\r\n\r\n  for (var i = 0; i < 2; i++) {\r\n    figX = figXArray[i];\r\n    if (colorY < 8 && colorY >= 0 && board[colorY][figX] &&\r\n    board[colorY][figX].color !== this.color) moves.push({x: figX, y: colorY});\r\n  }\r\n  \r\n\r\n  for (var i = 0; i < 2; i++) {\r\n    figX = figXArray[i];\r\n    last = turn[length - 1];\r\n\r\n    if (\r\n      last && last.to.x === figX && last.to.y === y && last.color !== this.color &&\r\n      (last.from.y === 1 || last.from.y === 6) && (y === 3 || y === 4)\r\n    ) {\r\n      moves.push({\r\n        x: figX,\r\n        y: colorY,\r\n        movePiece: {\r\n          piece: game.board[y][figX],\r\n          from: {\r\n            x: figX,\r\n            y: y\r\n          },\r\n          to: null\r\n        }\r\n      })\r\n\r\n    }\r\n  }\r\n\r\n  var validMoves = [];\r\n  if (simulate) {\r\n    validMoves = game.simulateAndFilter(moves, this);\r\n  }else{\r\n    validMoves = moves;\r\n  }\r\n\r\n  return validMoves;\r\n};\r\n\r\nPiece.pawn = function(x, y, color, game) {\r\n  return new Pawn(x, y, color, game);\r\n};\r\n\r\n// //\r\n\r\nfunction Rook(x, y, color, game) {\r\n  Piece.call(this, x, y, PIECE_CHARS.rook, color, game, 'rook');\r\n}\r\n\r\nRook.prototype = Piece.empty();\r\nRook.prototype.getValidMoves = function(simulate) {\r\n  var game = this.game;\r\n  var moves = [];\r\n\r\n  [[-1, 0], [1, 0], [0, 1], [0, -1]].forEach(function (coef) {\r\n    var index, x, y, piece;\r\n    for (index = 1; ; index++) {\r\n      x = this.x + coef[0] * index;\r\n      y = this.y + coef[1] * index;\r\n      if (0 > y || y > 7 || 0 > x || x > 7) break;\r\n\r\n      piece = game.board[y][x];\r\n      if (piece && piece.color === this.color) break;\r\n\r\n      moves.push({x: x, y: y});\r\n      if (piece) break;\r\n    }\r\n  }, this);\r\n\r\n  var validMoves = [];\r\n  if (simulate) {\r\n    validMoves = game.simulateAndFilter(moves, this);\r\n  }else{\r\n    validMoves = moves;\r\n  }\r\n\r\n  return validMoves;\r\n};\r\n\r\nPiece.rook = function(x, y, color, game) {\r\n  return new Rook(x, y, color, game);\r\n};\r\n\r\n// //\r\n\r\nfunction Knight(x, y, color, game) {\r\n  Piece.call(this, x, y, PIECE_CHARS.knight, color, game, 'knight');\r\n}\r\n\r\nKnight.prototype = Piece.empty();\r\nKnight.prototype.getValidMoves = function(simulate) {\r\n  var game = this.game;\r\n  var moves = [];\r\n  var task = false;\r\n\r\n  var coordinates = [ [2, 1], [-2, 1], [1, 2], [-1, 2], [2, -1], [-2, -1], [1, -2], [-1, -2] ];\r\n\r\n  var one, two;\r\n  for (var i = 0; i < coordinates.length; i++) {\r\n    var help = false;\r\n    var boardPiece;\r\n    one = coordinates[i][0];\r\n    two = coordinates[i][1];\r\n    \r\n    if(this.x + one < 8 && this.x + one >= 0 && this.y + two < 8 && this.y + two >= 0){\r\n      boardPiece = game.board[this.y + two][this.x + one];\r\n      help = boardPiece ? boardPiece.color != this.color : true;\r\n    }\r\n    \r\n    if (help) {\r\n      moves.push({x: this.x + one, y: this.y + two});\r\n    }\r\n  }\r\n\r\n  var validMoves = [];\r\n  if (simulate) {\r\n    validMoves = game.simulateAndFilter(moves, this);\r\n  }else{\r\n    validMoves = moves;\r\n  }\r\n\r\n  return validMoves;\r\n};\r\n\r\nPiece.knight = function(x, y, color, game) {\r\n  return new Knight(x, y, color, game);\r\n};\r\n\r\n// //\r\n\r\nfunction Bishop(x, y, color, game) {\r\n  Piece.call(this, x, y, PIECE_CHARS.bishop, color, game, 'bishop');\r\n}\r\n\r\nBishop.prototype = Piece.empty();\r\nBishop.prototype.getValidMoves = function(simulate) {\r\n  var game = this.game;\r\n  var moves = [];\r\n\r\n  [[-1, -1], [1, 1], [-1, 1], [1, -1]].forEach(function (coef) {\r\n    var index, x, y, piece;\r\n    for (index = 1; ; index++) {\r\n      x = this.x + coef[0] * index;\r\n      y = this.y + coef[1] * index;\r\n      if (0 > y || y > 7 || 0 > x || x > 7) break;\r\n\r\n      piece = game.board[y][x];\r\n      if (piece && piece.color === this.color) break;\r\n\r\n      moves.push({x: x, y: y});\r\n      if (piece) break;\r\n    }\r\n  }, this);\r\n\r\n  var validMoves = [];\r\n  if (simulate) {\r\n    validMoves = game.simulateAndFilter(moves, this);\r\n  }else{\r\n    validMoves = moves;\r\n  }\r\n\r\n  return validMoves;\r\n};\r\n\r\nPiece.bishop = function(x, y, color, game) {\r\n  return new Bishop(x, y, color, game);\r\n};\r\n\r\n// //\r\n\r\nfunction Queen(x, y, color, game) {\r\n  Piece.call(this, x, y, PIECE_CHARS.queen, color, game, 'queen');\r\n}\r\n\r\nQueen.prototype = Piece.empty();\r\nQueen.prototype.getValidMoves = function (simulate) {\r\n  var game = this.game;  \r\n  var rookMoves = Rook.prototype.getValidMoves.call(this);\r\n  var bishopMoves = Bishop.prototype.getValidMoves.call(this);\r\n  var moves = rookMoves.concat(bishopMoves);\r\n\r\n  var validMoves = [];\r\n  if (simulate) {\r\n    validMoves = game.simulateAndFilter(moves, this);\r\n  }else{\r\n    validMoves = moves;\r\n  }\r\n\r\n  return validMoves;\r\n};\r\n\r\nPiece.queen = function(x, y, color, game) {\r\n  return new Queen(x, y, color, game);\r\n};\r\n\r\n// //\r\n\r\nfunction King(x, y, color, game) {\r\n  Piece.call(this, x, y, PIECE_CHARS.king, color, game, 'king');\r\n}\r\n\r\nKing.prototype = Piece.empty();\r\nKing.prototype.getValidMoves = function(simulate) {\r\n  var moves = [];\r\n  var rochade;\r\n  var coordinates = [ [0, 1], [0, -1], [1, 1], [-1, -1], [1, -1], [-1, 1], [-1, 0], [1, 0] ];\r\n  var x = this.x, y = this.y;\r\n  var game = this.game;\r\n  var turn = game.turn, length = turn.length;\r\n  var self = this;\r\n\r\n  coordinates.forEach(function (coord) {\r\n    var piece;\r\n    var xx = x + coord[0];\r\n    var yy = y + coord[1];\r\n    \r\n    if (xx < 8 && xx >= 0 && yy < 8 && yy >= 0 ) {\r\n      piece = game.board[yy][xx];\r\n      if (!piece || piece.color != self.color) {\r\n        moves.push({x: xx, y: yy});\r\n      }\r\n    }\r\n  });\r\n\r\n  // Check king hasn't moved\r\n  var kingMoved = turn.some(function (turn) {\r\n    return turn.type === 'king' && turn.color === self.color;\r\n  });\r\n\r\n  if (!kingMoved) {\r\n    [[0, 2, -1], [7, 6, +1]].forEach(function (props) {\r\n      var rookX = props[0];\r\n      var newKingX = props[1];\r\n      var dir = props[2];\r\n      var rook = game.board[y][rookX];\r\n\r\n      // Check rook on position\r\n      if (!rook || !rook.type === 'rook') return;\r\n\r\n      // Check rook hasn't moved\r\n      if (turn.some(function (ev) {\r\n        return ev.from.x === rookX && ev.from.y === y;\r\n      })) return;\r\n\r\n      // Check squares empty and safe\r\n      for (var xx = x + dir; xx !== rookX; xx += dir) {\r\n        if (game.board[y][xx]) return;\r\n        var safe = true;\r\n        game.board.forEach(function (ev) {\r\n          ev.forEach(function (evv) {\r\n            if (evv && evv.type !== \"king\" && evv.color !== self.color) {\r\n              evv.getValidMoves().forEach(function(evMove){\r\n                if(evMove && evMove.y === y && evMove.x === xx) safe = false;\r\n              });\r\n            }\r\n          });\r\n        });\r\n        if(!safe) return;\r\n      }\r\n\r\n      var rochade = {\r\n        x: newKingX,\r\n        y: y,\r\n        movePiece: {\r\n          piece: self.game.board[y][rookX],\r\n          from: {\r\n            x: rookX, y: y\r\n          },\r\n          to: {\r\n            y: y, x: x + dir\r\n          }\r\n        }\r\n      }\r\n\r\n      moves.push( rochade )\r\n    });\r\n  }\r\n\r\n  var validMoves = [];\r\n  if (simulate) {\r\n    validMoves = game.simulateAndFilter(moves, self);\r\n  }else{\r\n    validMoves = moves;\r\n  }\r\n\r\n  return validMoves;\r\n};\r\n\r\nPiece.king = function(x, y, color, game) {\r\n  return new King(x, y, color, game);\r\n};\r\n\r\nexport { Piece, Pawn, Rook, Knight, Bishop, Queen, King };\n\n\n// WEBPACK FOOTER //\n// ./src/pieces.js","//\r\n// RSG Chess\r\n// Licensed under Apache 2.0 LICENSE\r\n\r\nconst Chess_AI = function (game){\r\n  var board = game.board;\r\n  // best values /bestMove & bestValue/\r\n  var bestMove = null;\r\n  var bestValue = -9999;\r\n  game.allMoves().forEach(function(ev){\r\n    var from = ev.from;\r\n    var piece = board[from.y][from.x];\r\n    var to = ev.to;\r\n\r\n    var movePiece = board[to.y][to.x] ? {\r\n      piece: board[to.y][to.x],\r\n      from: { x: to.x, y: to.y },\r\n      to: null\r\n    } : null;\r\n\r\n    // check for en-passant, and already captured pieces /movePiece/\r\n    if(to.movePiece) movePiece = to.movePiece;\r\n    if(movePiece) game.simpleMovePiece(movePiece.piece, movePiece.from, movePiece.to);\r\n    // simulate the current move from .getValidMoves() array /to/\r\n    game.simpleMovePiece(piece, from, { x: to.x, y: to.y });\r\n    // evulate the board and get the best move /boardValue > bestValue -> bestMove = {.../\r\n    var boardValue = -evaluateBoard(board);\r\n    if (\r\n      boardValue > bestValue && board[to.y][to.x].color === 'B'\r\n    ) {\r\n      bestValue = boardValue;\r\n      bestMove = { from: from, to: to };\r\n    }\r\n\r\n    // return the current move /ev/\r\n    game.simpleMovePiece(piece, { x: to.x, y: to.y }, from);\r\n    if(movePiece) game.simpleMovePiece(movePiece.piece, movePiece.to, movePiece.from);\r\n  })\r\n  // return the best move\r\n  return bestMove;\r\n};\r\n\r\nvar evaluateBoard = function (board) {\r\n  var totalEvaluation = 0;\r\n  for (var i = 0; i < 8; i++) {\r\n    for (var j = 0; j < 8; j++) {\r\n      // calculate the current evaluation\r\n      totalEvaluation = totalEvaluation + getPieceValue(board[i][j]);\r\n    }\r\n  }\r\n  // return the total evaluation\r\n  return totalEvaluation;\r\n};\r\n\r\nvar getPieceValue = function (piece) {\r\n  if (piece === null) {\r\n    return 0;\r\n  }\r\n\r\n  // get value for every piece on the board\r\n  var getAbsoluteValue = function (piece) {\r\n    if (piece.type === 'pawn') {\r\n      return 10;\r\n    } else if (piece.type === 'rook') {\r\n      return 50;\r\n    } else if (piece.type === 'knight') {\r\n      return 30;\r\n    } else if (piece.type === 'bishop') {\r\n      return 30 ;\r\n    } else if (piece.type === 'queen') {\r\n      return 90;\r\n    } else if (piece.type === 'king') {\r\n      return 900;\r\n    }\r\n    throw \"Unknown piece: \" + piece.type;\r\n  };\r\n\r\n  // calculate the absolute value and return it\r\n  var absoluteValue = getAbsoluteValue(piece, piece.color === 'W');\r\n  return piece.color === 'W' ? absoluteValue : -absoluteValue;\r\n};\r\n\r\n// export the algorithm\r\nexport default Chess_AI\r\n\r\n// Written by Radi Cho\r\n// RSG Chess - by RSG Group\n\n\n// WEBPACK FOOTER //\n// ./src/AI.js","// Let's import...\r\nimport Game from \"./game\";\r\nimport * as Piece from \"./pieces\";\r\nimport AI from \"./AI\";\r\n\r\nconst Graphics = \"This feature is coming soon!\"\r\n\r\n// And export...\r\nexport {\r\n  Game,\r\n  Piece,\r\n  AI,\r\n  Graphics\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import { Piece }    from './pieces.js';\r\nimport Chess_AI from './AI.js';\r\n\r\nfunction Game(promoCallback) {\r\n  // the game board\r\n  this.board = [];\r\n  // fill the board\r\n  for (var i = 0; i < 8; i++) {\r\n    var arrayIn = [];\r\n    for (var j = 0; j < 8; j++) {\r\n      arrayIn.push(null);\r\n    }\r\n    this.board.push(arrayIn);\r\n  }\r\n\r\n  // the history of all turns\r\n  this.turn = [];\r\n  // the current FEN status\r\n  this.FEN = [];\r\n  // the current game configuration as FEN\r\n  this.FENboard = [];\r\n  // the history of all game configurations displayed using FEN\r\n  this.threefold = [];\r\n}\r\n\r\nGame.prototype.piece = function (type, x, y, color) {\r\n  var piece = Piece[type](x, y, color, this);\r\n  this.board[y][x] = piece;\r\n\r\n  this.FEN = this.gameToFEN();\r\n  this.FENboard = this.boardToFEN();\r\n};\r\n\r\nGame.prototype.moveSelected = function (\r\n  selected, to, promotionCallback, checkmateCallback, playAgainstAI, simulate\r\n) {\r\n  var x = to.x;\r\n  var y = to.y;\r\n\r\n  if (selected) {\r\n    var from = { x: selected.x, y: selected.y };\r\n\r\n    if (this.board[y][x] != selected) {\r\n      var validMoves = selected.getValidMoves(!simulate);\r\n      var validMove = null;\r\n      for (var i = 0; i < validMoves.length; i++) {\r\n        var vm = validMoves[i];\r\n        if (vm.x === x && vm.y === y ) {\r\n          validMove = vm;\r\n          break;\r\n        }\r\n      }\r\n\r\n      if (!validMove) return false;\r\n      \r\n      var movePiece = validMove.movePiece;\r\n      var take, paste, rook;\r\n      if (movePiece) {\r\n        take = movePiece.from;\r\n        paste = movePiece.to;\r\n        if (paste === null){\r\n          this.board[take.y][take.x] = null;\r\n        }else{\r\n          rook = this.board[take.y][take.x];\r\n          this.board[paste.y][paste.x] = rook;\r\n          rook.x = paste.x;\r\n          rook.y = paste.y;\r\n          this.board[take.y][take.x] = null;\r\n        }\r\n      }\r\n      \r\n      var piece = this.board[y][x] ? this.board[y][x] : null;\r\n      var movePiece = (movePiece ? validMove.movePiece : null);\r\n      this.turn.push({\r\n        from: from, to: to,\r\n        color: selected.color, type: selected.type,\r\n        piece: piece, movePiece: movePiece\r\n      });\r\n      \r\n      this.board[y][x] = selected;\r\n      this.board[selected.y][selected.x] = null;\r\n      this.board[y][x].x = x;\r\n      this.board[y][x].y = y;\r\n\r\n      this.FEN = this.gameToFEN();\r\n      this.FENboard = this.boardToFEN();\r\n      \r\n      // check for threefold repetition\r\n      this.threefold.push(this.FENboard);\r\n      if (selected.type === 'pawn' || piece) this.threefold = [];\r\n      if(this.threefoldCheck()) checkmateCallback('D');\r\n\r\n      // check for the fifty-move rule\r\n      if (this.halfmoveClock() >= 50) checkmateCallback('D');\r\n\r\n      // check for pawn promotion\r\n      if (selected.type === \"pawn\") {\r\n        if ((selected.color === \"W\" && y === 0) || (selected.color === \"B\" && y === 7)) {\r\n          if(promotionCallback) {\r\n            !playAgainstAI && selected.color === \"B\" ?\r\n              this.promotePawn(selected, x, y, selected.color, \"queen\"):\r\n              promotionCallback(selected, x, y, selected.color);\r\n          }\r\n        }\r\n      };\r\n      \r\n      var checkmateColor = selected.color === 'W' ? 'B' : 'W';\r\n      var checkmateValue = this.checkmate(checkmateColor);\r\n      if(checkmateValue) checkmateCallback(checkmateValue);\r\n\r\n      // Play AI\r\n      if (playAgainstAI) {\r\n        var bestMove = Chess_AI(this);\r\n        this.moveSelected(\r\n          this.board[bestMove.from.y][bestMove.from.x],\r\n          bestMove.to,\r\n          promotionCallback,\r\n          checkmateCallback,\r\n          false,\r\n          simulate\r\n        )\r\n      }\r\n      // end\r\n    }\r\n    selected = null;\r\n    return true;\r\n  }\r\n};\r\n\r\nGame.prototype.promotePawn = function (pawn, x, y, color, type) {\r\n  this.piece(type, x, y, color);\r\n};\r\n\r\nGame.prototype.simulateAndFilter = function (moves, piece) {\r\n  var validMoves = [], self = this, turn = self.turn, board = this.board;\r\n  moves.forEach(function (move, i) {\r\n    var y = move.y;\r\n    var x = move.x;\r\n    var from = { x: piece.x, y: piece.y };\r\n    var movePiece = board[y][x] ? {\r\n      piece: board[y][x],\r\n      from: { x: x, y: y },\r\n      to: null\r\n    } : null;\r\n    if(move.movePiece) movePiece = move.movePiece;\r\n\r\n    if(movePiece) self.simpleMovePiece(movePiece.piece, movePiece.from, movePiece.to);\r\n\r\n    self.simpleMovePiece(piece, from, { x: x, y: y });\r\n\r\n    var warning = self.warning(piece.color);\r\n\r\n    // Return king\r\n    self.simpleMovePiece(piece, { x: x, y: y }, from);\r\n\r\n    // return the movePiece with simpleMovePiece() method\r\n    if(movePiece) self.simpleMovePiece(movePiece.piece, movePiece.to, movePiece.from);\r\n    \r\n    if (!warning) validMoves.push(move);\r\n  });\r\n  return validMoves;\r\n}\r\n\r\nGame.prototype.checkmate = function(color){\r\n  // using let will allow us to make the code a bit simpler\r\n  for(let i = 0; i < 8; i++){\r\n\t\tfor(let j = 0; j < 8; j++){\r\n\t\t\tif (\r\n        this.board[i][j] &&\r\n        this.board[i][j].color === color &&\r\n        this.board[i][j].getValidMoves(true).length\r\n      ) return false;\r\n\t\t}\r\n  }\r\n  \r\n  if (this.warning(color)) return color;\r\n\treturn 'D';\r\n}\r\n\r\nGame.prototype.simpleMovePiece = function(piece, from, to){\r\n  var board = this.board;\r\n  if(to) {\r\n    board[to.y][to.x] = piece;\r\n    piece.x = to.x;\r\n    piece.y = to.y;\r\n  }\r\n  if(from) board[from.y][from.x] = null;\r\n}\r\n\r\nGame.prototype.warning = function (color) {\r\n  var result = false;\r\n  var king;\r\n\r\n  this.board.forEach(function(yyy){\r\n    yyy.forEach(function(xxx){\r\n      if(xxx && xxx.color === color && xxx.type === \"king\") {\r\n        king = xxx;\r\n      }\r\n    })\r\n  })\r\n\r\n  this.board.forEach(function(yyy){\r\n    yyy.forEach(function(xxx){\r\n      if(xxx && xxx.color !== color) {\r\n        xxx.getValidMoves().forEach(function(mmm){\r\n          if(mmm.x === king.x && mmm.y === king.y) result = true;\r\n        })\r\n      }\r\n    })\r\n  })\r\n  return result;\r\n};\r\n\r\nGame.prototype.threefoldCheck = function () {\r\n  var threefold = this.threefold;\r\n  var length = threefold.length;\r\n\r\n  for(var i = 0; i < length; i++){\r\n    // using let will allow us to make the code simpler\r\n    let count = 0;\r\n    for (var j = i + 1; j < length; j++) {\r\n      if(threefold[i] === threefold[j]) count += 1;\r\n    }\r\n    if(count >= 2) return true;\r\n  }\r\n  \r\n  return false;\r\n}\r\n\r\nGame.prototype.pieceToAN = function(x, y) {\r\n  var xChars = 'abcdefgh';\r\n  return xChars.charAt(x) + (8 - y);\r\n}\r\n\r\n// Support FEN functions in the API\r\nGame.prototype.boardToFEN = function () {\r\n  var board = this.board;\r\n \r\n  // Convert the board configuration into FEN\r\n  var FENboard = '';\r\n  var missingPieces = 0;\r\n  for (var i = 0; i < 8; i++) {\r\n    for (var j = 0; j < 8; j++) {\r\n      if(board[i][j]) {\r\n        if (missingPieces) FENboard += missingPieces;\r\n        missingPieces = 0;\r\n        FENboard += board[i][j].FENname;\r\n      } else {\r\n        missingPieces++;\r\n      }\r\n    }\r\n    if (missingPieces) FENboard += missingPieces;\r\n    missingPieces = 0;    \r\n    FENboard += i < 7 ? '/' : '';\r\n  }\r\n \r\n  return FENboard;\r\n};\r\n\r\nGame.prototype.halfmoveClock = function () {\r\n  var turn = this.turn;\r\n  var length = turn.length;\r\n  var count = 0;\r\n  if (turn.length === 0) return count;\r\n\r\n  var ev = turn[(length - 1) - count];\r\n  while(count <= length - 1 && ev.type !== 'pawn' && !ev.piece){\r\n    count++;\r\n    ev = turn[(length - 1) - count]; \r\n  }\r\n\r\n  return count;\r\n}\r\n\r\nGame.prototype.activeColour = function () {\r\n  var turn = this.turn;\r\n  var activeColor =\r\n    turn.length &&\r\n    turn[turn.length - 1].color === 'W' ? 'b' : 'w';\r\n\r\n  return activeColor;\r\n}\r\n\r\nGame.prototype.castlingTarget = function () {\r\n  var board = this.board,\r\n      turn = this.turn;\r\n      \r\n  var possibleCastling = '';\r\n \r\n  var whiteKingMoved;\r\n  var blackKingMoved;\r\n  turn.forEach(function (turn) {\r\n    whiteKingMoved = turn.type === 'king' && turn.color === 'W';\r\n    blackKingMoved = turn.type === 'king' && turn.color === 'B';\r\n  });\r\n \r\n  [[7, 0], [0, 0], [7, 7], [0, 7]].forEach(function (props) {\r\n    var rookX = props[0];\r\n    var rookY = props[1];\r\n    var rook = board[rookY][rookX];\r\n \r\n    // Check rook on position\r\n    if (!rook || !rook.type === 'rook') return;\r\n    // Check rook hasn't moved\r\n    if (turn.some(function (ev) {\r\n      return ev.from.x === rookX && ev.from.y === rookY;\r\n    })) return;\r\n \r\n    var castlingSide = rookX === 0 ? 'q' : 'k';\r\n    possibleCastling += rookY === 0 ? castlingSide.toUpperCase() : castlingSide;\r\n  });\r\n \r\n  if (!possibleCastling) possibleCastling = '-';\r\n  return possibleCastling;\r\n}\r\n\r\nGame.prototype.enPassantTarget = function () {\r\n  var turn = this.turn;\r\n  var enPassantTarget = '';\r\n\r\n  if (turn.length) {\r\n    var ev = turn[turn.length - 1];\r\n    if (ev.color === 'W' && ev.to.y === 4){\r\n      enPassantTarget = this.pieceToAN(ev.to.x, ev.to.y + 1)\r\n    }\r\n    \r\n    if (ev.color === 'B' && ev.to.y === 3){\r\n      enPassantTarget = this.pieceToAN(ev.to.x, ev.to.y - 1)\r\n    }\r\n  }\r\n\r\n  if (!enPassantTarget) enPassantTarget = '-';\r\n  return enPassantTarget;\r\n}\r\n\r\nGame.prototype.fullmoveCount = function() {\r\n  var count = 1;\r\n  this.turn.forEach(function(ev){\r\n    if (ev.color === 'B') count += 1;\r\n  });\r\n\r\n  return count;\r\n}\r\n\r\nGame.prototype.gameToFEN = function () {\r\n  var FEN = '';\r\n\r\n  // Check the board configuration\r\n  FEN += this.boardToFEN();\r\n \r\n  // Find the active colour\r\n  FEN += ' ' + this.activeColour();\r\n  \r\n  // Check castling availability\r\n  FEN += ' ' + this.castlingTarget();\r\n \r\n  // Check the En-passant target\r\n  FEN += ' ' + this.enPassantTarget();\r\n\r\n  // Add the halfmove clock\r\n  FEN += ' ' + this.halfmoveClock();\r\n\r\n  // Add the fullmove number\r\n  FEN += ' ' + this.fullmoveCount();\r\n\r\n  /*\r\n    More information about the FEN notation:\r\n    https://en.wikipedia.org/wiki/Forsyth%E2%80%93Edwards_Notation\r\n    https://chessprogramming.wikispaces.com/Forsyth-Edwards+Notation\r\n  */\r\n \r\n  return FEN;\r\n};\r\n\r\n// Set up default game configuration\r\nGame.prototype.initializeGame = function() {\r\n  var defaultGame = new Game();\r\n\r\n  // Pawns:\r\n  for (var i = 0; i < 8; i++) {\r\n    defaultGame.piece('pawn', i, 6, 'W');\r\n    defaultGame.piece('pawn', i, 1, 'B');\r\n  }\r\n  \r\n  // Black figs:\r\n  defaultGame.piece('rook', 0, 0, 'B');\r\n  defaultGame.piece('knight', 1, 0, 'B');\r\n  defaultGame.piece('bishop', 2, 0, 'B');\r\n  defaultGame.piece('queen', 3, 0, 'B');\r\n  defaultGame.piece('king', 4, 0, 'B');\r\n  defaultGame.piece('bishop', 5, 0, 'B');\r\n  defaultGame.piece('knight', 6, 0, 'B');\r\n  defaultGame.piece('rook', 7, 0, 'B');\r\n  \r\n  // White figs:\r\n  defaultGame.piece('rook', 0, 7, 'W');\r\n  defaultGame.piece('knight', 1, 7, 'W');\r\n  defaultGame.piece('bishop', 2, 7, 'W');\r\n  defaultGame.piece('queen', 3, 7, 'W');\r\n  defaultGame.piece('king', 4, 7, 'W');\r\n  defaultGame.piece('bishop', 5, 7, 'W');\r\n  defaultGame.piece('knight', 6, 7, 'W');\r\n  defaultGame.piece('rook', 7, 7, 'W');\r\n\r\n  return defaultGame;\r\n}\r\n\r\nGame.prototype.allMoves = function() {\r\n  var board = this.board;\r\n  var\r\n    allMoves = [],\r\n    activeColour = this.activeColour().toUpperCase();\r\n\r\n  for (var i = 0; i < 8; i++) {\r\n    for (var j = 0; j < 8; j++) {\r\n      if (board[i][j] && board[i][j].color === activeColour) {\r\n        var validMoves = board[i][j].getValidMoves();\r\n        validMoves.forEach(function(ev){\r\n          allMoves.push({\r\n            color: board[i][j].color,\r\n            from: {x: j, y: i},\r\n            to: ev,\r\n            FENname: board[i][j].FENname\r\n          });\r\n        })\r\n      }\r\n    }\r\n  }\r\n\r\n  return allMoves;\r\n}\r\n\r\nexport default Game;\n\n\n// WEBPACK FOOTER //\n// ./src/game.js","import { Game } from '../src/index';\r\nimport { AI } from '../src/index';\r\n\r\n// initialize test game configuration\r\nconst game = Game.prototype.initializeGame();\r\ngame.moveSelected(\r\n  game.board[6][0], { y: 5, x: 0 }, ()=>{}, ()=>{}, false, false\r\n)\r\n\r\nconst bestAI = new AI(game);\r\n\r\nconsole.log(game.allMoves().length);\r\nconsole.log(bestAI);\n\n\n// WEBPACK FOOTER //\n// ./test/index.js"],"sourceRoot":""}